<!-- Topbar -->
<style>
    /* Estilos para hacer el navbar semitransparente */
    .navbar.navbar-dark.bg-dark {
        background-color: rgba(33, 37, 41, 0.7) !important; /* Color oscuro semitransparente */
        backdrop-filter: blur(10px); /* Efecto de desenfoque */
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); /* Sombra sutil */
        border-bottom: 1px solid rgba(255, 255, 255, 0.05); /* Borde inferior sutil */
        position: fixed; /* Mantiene la barra fija durante el scroll */
        top: 0; /* Pegada a la parte superior */
        width: 100%; /* Ocupa todo el ancho */
        z-index: 1030; /* Asegura que esté por encima de otros elementos */
    }

    /* Añadimos un espaciador para evitar que el contenido se oculte debajo del navbar */
    body {
        padding-top: 56px; /* Ajustar según la altura de tu navbar */
    }

    /* Añadir comportamiento de scroll suave para toda la página */
    html {
        scroll-behavior: smooth;
    }

    .navbar-brand {
        color: rgba(255, 255, 255, 0.9) !important; /* Texto más visible */
        font-size: 1.25rem !important; /* Tamaño específico para garantizar consistencia */
        font-weight: 600; /* Peso de fuente para mejor legibilidad */
    }

    .navbar-nav .nav-link {
        color: rgba(255, 255, 255, 0.9) !important; /* Texto más visible */
        font-size: 1rem !important; /* Tamaño específico para garantizar consistencia */
    }

    .navbar-nav .nav-link:hover {
        color: #ffffff !important;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    }

    .navbar-nav .nav-link.active {
        color: #e9f990 !important; /* Color accent-color similar al usado en otros lugares */
        font-weight: 600;
    }

    /* Estilos para el avatar del usuario */
    .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid rgba(255, 255, 255, 0.5);
        vertical-align: middle;
    }
    
    .avatar-link {
        display: flex;
        align-items: center;
        justify-content: center;
        padding-top: 0.5rem;
        padding-bottom: 0.5rem;
        height: 100%;
    }
    
    .avatar-link.active .user-avatar {
        border-color: #e9f990;
        box-shadow: 0 0 0 2px rgba(233, 249, 144, 0.5);
    }

    /* Para mantener consistencia en la altura del elemento de navegación con el avatar */
    .navbar-nav .nav-item {
        display: flex;
        align-items: center;
    }

    /* Ajuste para móviles */
    @media (max-width: 992px) {
        .navbar-collapse {
            background-color: rgba(33, 37, 41, 0.95);
            backdrop-filter: blur(15px);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
        }
    }
</style>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <!-- Brand -->
        <a class="navbar-brand" href="/">LostAtNight</a>

        <!-- Mobile Toggle Button -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navbar Links -->
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link {% if current_path == '/' %}active{% endif %}" href="/">Home</a></li>
                <li class="nav-item"><a class="nav-link scroll-link" href="{% if not is_homepage %}/{% endif %}#batch-section" data-section="batch-section">Batches</a></li>
                <li class="nav-item"><a class="nav-link scroll-link" href="{% if not is_homepage %}/{% endif %}#statistics-section" data-section="statistics-section">Statistics</a></li>
                <li class="nav-item"><a class="nav-link {% if current_path == '/gettask' %}active{% endif %}" href="/gettask">Participate</a></li>
                <li class="nav-item"><a class="nav-link scroll-link" href="{% if not is_homepage %}/{% endif %}#contact-section" data-section="contact-section">Contact</a></li>
                {% if user.is_authenticated %}
                <li class="nav-item">
                    <a class="nav-link avatar-link {% if current_path == '/user-profile' %}active{% endif %}" href="/user-profile" title="Tu área personal">
                        {% if user.userprofile.profile_pic %}
                            <img src="{{ user.userprofile.profile_pic.url }}" alt="Imagen de perfil" class="user-avatar">
                        {% else %}
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-person-circle user-avatar" viewBox="0 0 16 16" style="background-color: rgba(255,255,255,0.2); padding: 2px;">
                                <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                                <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                            </svg>
                        {% endif %}
                    </a>
                </li>
                {% else %}
                <li class="nav-item"><a class="nav-link {% if current_path == '/accounts/login' %}active{% endif %}" href="/accounts/login">Login</a></li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>